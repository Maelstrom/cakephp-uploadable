Uploadable Behavior

Install:

Save the UploadableBehavior.php file to your app/Model/Behavior/ folder.

Then its as easy as adding it to the actsAs on your model.

For a real world example lets say I have a model named Recipe and it contains a field named photo. I want photo to be an uploaded file so I setup my model:

	<?php

	/**
	 * Recipe Model
	 */
	class Recipe extends AppModel {

		/**
		 * Define the behavior of this model
		 * 
		 * @var array 
		 */
		public $actsAs = array('Uploadable');
	}
	
	?>

Now I need to create my add.ctp page:

	<?php
		echo $this->Form->create('Recipe', array('enctype' => 'multipart/form-data')); 
		echo $this->Form->input('title');
		echo $this->Form->input('photo', array('type' => 'file'));
		echo $this->Form->end(__('Submit'));
	?>

Thats all I need to do to allow images to be uploaded. In my controller the code is the same:

	public function admin_add() {
		if ($this->request->is('post')) {
			$this->Recipe->create();
			if ($this->Recipe->save($this->request->data)) {
				$this->Session->setFlash(__('The recipe has been saved'));
				$this->redirect(array('action' => 'index'));
			} else {
				$this->Session->setFlash(__('The recipe could not be saved. Please, try again.'));
			}
		}
		$recipeCategories = $this->Recipe->RecipeCategory->find('list');
		$this->set(compact('recipeCategories'));
	}



Special Configuration

Example of a configuration:

This is the default which default will get applied to all fields:

    Options = array(
        'default' => array(
            'accept' => array(
                'image/jpeg' => array('jpg', 'jpeg'),
                'image/gif' => array('gif'),
                'image/png' => array('png')
            ),
            'path' => 'media',
            'prefix' => 'upload'
        )
    );

In your model you can define many options specifically if you want this to only work on a specific field rather than all just set defaults accept param to false:

     $actsAs = array(
             'Uploadable' => array(
                 'default' => array('accept' => false),
                 'photo' => array(
                     'accept' => array(
                         'image/jpeg' => array('jpg', 'jpeg'),
                         'image/gif' => array('gif'),
                         'image/png' => array('png')
                     ),
                     'path' => 'media',
                     'prefix' => 'upload'
                 )
             )
     )

Let me know if you have any problems.
